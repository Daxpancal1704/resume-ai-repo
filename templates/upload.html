<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Resume Analyzer</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    >

    <style>
        body {
            background: linear-gradient(135deg, #eef2ff, #f8fafc);
            min-height: 100vh;
        }

        .card {
            border: none;
            border-radius: 14px;
            box-shadow: 0 12px 30px rgba(0,0,0,0.08);
        }

        .badge-skill {
            margin: 4px;
            font-size: 0.9rem;
        }

        .loading-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(255,255,255,0.85);
            z-index: 9999;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
    </style>
</head>
<body>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
    <div class="spinner-border text-primary mb-3" role="status"></div>
    <strong>Analyzing resume…</strong>
</div>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-6">

            <div class="card p-4">
                <h3 class="text-center mb-4 fw-bold">Resume Analyzer</h3>

                <!-- Upload Form -->
                <form method="post" enctype="multipart/form-data" onsubmit="showLoader()">
                    {% csrf_token %}

                    <div class="mb-3">
                        <label class="form-label fw-semibold">Full Name</label>
                        <input type="text"
                               class="form-control"
                               name="name"
                               placeholder="Enter your full name"
                               required>
                    </div>

                    <div class="mb-4">
                        <label class="form-label fw-semibold">Upload Resume (PDF)</label>
                        <input type="file"
                               class="form-control"
                               name="resume"
                               accept=".pdf"
                               required>
                        <div class="form-text">Only PDF files are supported.</div>
                    </div>

                    <button class="btn btn-primary w-100 py-2 fw-semibold">
                        Analyze Resume
                    </button>
                </form>

                <!-- Error Message -->
                {% if error %}
                <div class="alert alert-danger mt-3">
                    {{ error }}
                </div>
                {% endif %}

                <!-- Analysis Result -->
                {% if percentage %}
                <hr class="my-4">
                <h5 class="fw-bold text-center">Best Matched Role</h5>
                        <div class="text-center mb-3">
                      <span class="badge bg-primary fs-6 px-3 py-2">
                                         {{ best_role }}
                      </span>
                                    </div>

                <!-- Match Percentage -->
                <div class="text-center mb-3">
                    <h5 class="fw-bold">Match Percentage</h5>
                    <div class="display-6 text-success fw-bold">
                        {{ percentage }}%
                    </div>
                </div>

                <!-- AI Verdict -->
                <div class="text-center mb-4">
                    <h6 class="fw-semibold">AI Verdict</h6>

                    {% if verdict == "Strong Match" %}
                        <span class="badge bg-success fs-6 px-3 py-2">
                            {{ verdict }}
                        </span>
                    {% elif verdict == "Moderate Match" %}
                        <span class="badge bg-warning text-dark fs-6 px-3 py-2">
                            {{ verdict }}
                        </span>
                    {% else %}
                        <span class="badge bg-danger fs-6 px-3 py-2">
                            {{ verdict }}
                        </span>
                    {% endif %}
                </div>

                <!-- AI Resume Suggestions -->
                {% if suggestions %}
                <h6 class="fw-semibold">AI Resume Suggestions</h6>
                <ul class="list-group mb-4">
                    {% for tip in suggestions %}
                        <li class="list-group-item">
                            {{ tip }}
                        </li>
                    {% endfor %}
                </ul>
                {% endif %}

                <!-- Matched Skills -->
                {% if matched_skills %}
                <h6 class="fw-semibold">Matched Skills</h6>
                <div class="mb-3">
                    {% for skill in matched_skills %}
                        <span class="badge bg-success badge-skill">
                            {{ skill }}
                        </span>
                    {% endfor %}
                </div>
                {% endif %}

                <!-- Missing Skills -->
                {% if missing_skills %}
                <h6 class="fw-semibold">Missing Skills</h6>
                <div class="mb-3">
                    {% for skill in missing_skills %}
                        <span class="badge bg-danger badge-skill">
                            {{ skill }}
                        </span>
                    {% endfor %}
                </div>
                {% endif %}

                {% endif %}

                <!-- History Link -->
                <div class="text-center mt-4">
                    <a href="/history/" class="link-primary fw-semibold">
                        View Analysis History →
                    </a>
                </div>

            </div>

        </div>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
    function showLoader() {
        document.getElementById("loadingOverlay").style.display = "flex";
    }
</script>

</body>
</html>
